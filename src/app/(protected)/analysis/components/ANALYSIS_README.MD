# üè∑Ô∏è TaggerLPL - Framework de M√©triques Modulaires

## üìã Vue d'ensemble du Framework

TaggerLPL impl√©mente un **framework unifi√© de m√©triques modulaires** pour l'analyse conversationnelle et linguistique interactionnelle. L'architecture permet la comparaison scientifique d'algorithmes multiples sur les m√™mes donn√©es, avec validation crois√©e AC-LI-Cognitif.

### üéØ Objectifs du Framework

- ‚úÖ **Architecture modulaire** : Indicateurs comparables et algorithmes interchangeables
- ‚úÖ **Validation scientifique** : M√©triques de performance, annotation experte, convergence
- ‚úÖ **Interface comparative** : Visualisation c√¥te-√†-c√¥te des r√©sultats d'algorithmes
- üîÑ **Machine Learning supervis√©** : Entra√Ænement de mod√®les avec annotations expertes
- üîÑ **Validation crois√©e** : Tests de convergence AC-LI-Cognitif automatis√©s

## üèóÔ∏è Architecture du Framework

### Structure g√©n√©rale

```
src/app/(protected)/analysis/components/
‚îú‚îÄ‚îÄ üìÇ metrics-framework/       # üîß FRAMEWORK COMMUN (√† impl√©menter)
‚îú‚îÄ‚îÄ üìÇ li-metrics/             # üó£Ô∏è LINGUISTIQUE INTERACTIONNELLE
‚îú‚îÄ‚îÄ üìÇ cognitive-metrics/      # üß† SCIENCES COGNITIVES
‚îî‚îÄ‚îÄ üìÇ shared/                 # üîó COMPOSANTS PARTAG√âS
```

### Framework de m√©triques modulaires (Planifi√©)

```
metrics-framework/                      # üîß FRAMEWORK COMMUN
‚îú‚îÄ‚îÄ üìÇ core/
‚îÇ   ‚îú‚îÄ‚îÄ MetricsRegistry.ts              # Registre universel d'indicateurs
‚îÇ   ‚îú‚îÄ‚îÄ BaseIndicator.ts                # Classe de base pour tous indicateurs
‚îÇ   ‚îú‚îÄ‚îÄ AlgorithmStrategy.ts            # Interface strat√©gies d'algorithmes
‚îÇ   ‚îú‚îÄ‚îÄ MetricsEngine.ts                # Moteur de calcul unifi√©
‚îÇ   ‚îú‚îÄ‚îÄ ValidationEngine.ts             # Moteur de validation convergence
‚îÇ   ‚îî‚îÄ‚îÄ types/
‚îÇ       ‚îú‚îÄ‚îÄ base.ts                     # Types fondamentaux
‚îÇ       ‚îú‚îÄ‚îÄ indicators.ts               # Types pour indicateurs
‚îÇ       ‚îú‚îÄ‚îÄ algorithms.ts               # Types pour algorithmes
‚îÇ       ‚îú‚îÄ‚îÄ results.ts                  # Types pour r√©sultats
‚îÇ       ‚îî‚îÄ‚îÄ annotations.ts              # Types pour syst√®me d'annotation
‚îÇ
‚îú‚îÄ‚îÄ üìÇ hooks/
‚îÇ   ‚îú‚îÄ‚îÄ useMetricsEngine.ts             # Hook principal unifi√©
‚îÇ   ‚îú‚îÄ‚îÄ useIndicatorRegistry.ts         # Gestion registre dynamique
‚îÇ   ‚îú‚îÄ‚îÄ useAlgorithmBenchmarking.ts     # Syst√®me de benchmarking
‚îÇ   ‚îú‚îÄ‚îÄ useAnnotationWorkflow.ts        # Workflow annotation supervis√©e
‚îÇ   ‚îú‚îÄ‚îÄ useConvergenceValidation.ts     # Validation crois√©e AC-LI-Cognitif
‚îÇ   ‚îú‚îÄ‚îÄ useMetricsByFamily.ts           # Analyse par famille de strat√©gies
‚îÇ   ‚îú‚îÄ‚îÄ useMLTraining.ts                # Entra√Ænement mod√®les ML
‚îÇ   ‚îî‚îÄ‚îÄ usePerformanceMonitoring.ts     # Monitoring temps r√©el
‚îÇ
‚îú‚îÄ‚îÄ üìÇ components/
‚îÇ   ‚îú‚îÄ‚îÄ MetricIndicatorCard.tsx         # Carte d'indicateur universelle
‚îÇ   ‚îú‚îÄ‚îÄ AlgorithmComparisonView.tsx     # Comparaison algorithmes ligne par ligne
‚îÇ   ‚îú‚îÄ‚îÄ AnnotationInterface.tsx         # Interface annotation experte
‚îÇ   ‚îú‚îÄ‚îÄ BenchmarkDashboard.tsx          # Dashboard performance comparative
‚îÇ   ‚îú‚îÄ‚îÄ ValidationDashboard.tsx         # Dashboard validation convergence
‚îÇ   ‚îú‚îÄ‚îÄ ConvergenceVisualization.tsx    # Graphiques convergence
‚îÇ   ‚îî‚îÄ‚îÄ MLTrainingInterface.tsx         # Interface entra√Ænement ML
‚îî‚îÄ‚îÄ üìÇ utils/
    ‚îú‚îÄ‚îÄ dataPreprocessing.ts            # Pr√©processing donn√©es Supabase
    ‚îú‚îÄ‚îÄ featureExtraction.ts            # Extraction features ML
    ‚îú‚îÄ‚îÄ algorithmValidation.ts          # Validation et m√©triques qualit√©
    ‚îî‚îÄ‚îÄ mlHelpers.ts                    # Helpers ML/NLP
```

## üó£Ô∏è Domaine LI (Linguistique Interactionnelle)

### √âtat d'impl√©mentation

```
li-metrics/                             # üó£Ô∏è LINGUISTIQUE INTERACTIONNELLE
‚îú‚îÄ‚îÄ üìÇ indicators/
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ FeedbackAlignmentIndicator/  # ‚úÖ IMPL√âMENT√â
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ algorithms/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BasicAlignmentAlgorithm.ts      # ‚úÖ Analyse s√©mantique verbatims
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SentimentEnhancedAlgorithm.ts   # üîÑ √Ä IMPL√âMENTER
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SequentialPatternAlgorithm.ts   # üîÑ √Ä IMPL√âMENTER
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useFeedbackAlignmentMetrics.ts  # ‚úÖ Hook complet
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useFeedbackAlignmentAnnotation.ts # üîÑ √Ä IMPL√âMENTER
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FeedbackAlignmentInterface.tsx      # ‚úÖ Interface compl√®te
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ types.ts                            # ‚úÖ Types complets
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ CommonGroundIndicator/       # üîÑ √Ä IMPL√âMENTER
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ BackchannelsIndicator/       # üîÑ √Ä IMPL√âMENTER
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ ProsodicFluencyIndicator/    # üîÑ √Ä IMPL√âMENTER
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ SpeechRateIndicator/         # üîÑ √Ä IMPL√âMENTER
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ SequentialPatternsIndicator/ # üîÑ √Ä IMPL√âMENTER
‚îÇ   ‚îî‚îÄ‚îÄ üìÇ RepairMechanismsIndicator/   # üîÑ √Ä IMPL√âMENTER
‚îÇ
‚îú‚îÄ‚îÄ LIMetricsConfig.ts                  # üîÑ √Ä IMPL√âMENTER
‚îú‚îÄ‚îÄ LIMetricsRegistry.ts                # üîÑ √Ä IMPL√âMENTER
‚îî‚îÄ‚îÄ LinguisticInteractionalMetrics.tsx  # üîÑ √Ä IMPL√âMENTER
```

## üß† Domaine Cognitive (Sciences Cognitives)

### √âtat d'impl√©mentation

```
cognitive-metrics/                      # üß† SCIENCES COGNITIVES
‚îú‚îÄ‚îÄ üìÇ indicators/
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ FluiditeCognitiveIndicator/  # ‚úÖ EXISTANT (√† migrer vers framework)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ algorithms/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BasicFluidityAlgorithm.ts       # üîÑ √Ä MIGRER (existant en hook)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ NeuronMirrorAlgorithm.ts        # üîÑ √Ä IMPL√âMENTER
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ MLEnhancedAlgorithm.ts          # üîÑ √Ä IMPL√âMENTER
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useFluiditeCognitiveMetrics.ts  # üîÑ √Ä CR√âER (migration)
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useFluidityAnnotation.ts        # üîÑ √Ä IMPL√âMENTER
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FluiditeCognitiveInterface.tsx      # üîÑ √Ä CR√âER
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ types.ts                            # üîÑ √Ä CR√âER
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ ReactionsDirectesIndicator/  # ‚úÖ EXISTANT (√† migrer)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ algorithms/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BasicReactionsAlgorithm.ts      # üîÑ √Ä MIGRER
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ContextualReactionsAlgorithm.ts # üîÑ √Ä IMPL√âMENTER
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ... (m√™me structure)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ ReprisesLexicalesIndicator/  # ‚úÖ EXISTANT (√† migrer)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ algorithms/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BasicReprisesAlgorithm.ts       # üîÑ √Ä MIGRER
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SemanticReprisesAlgorithm.ts    # üîÑ √Ä IMPL√âMENTER
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ... (m√™me structure)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ ChargeCognitiveIndicator/    # ‚úÖ EXISTANT (√† migrer)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ algorithms/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BasicChargeAlgorithm.ts         # üîÑ √Ä MIGRER
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ MultiFactorChargeAlgorithm.ts   # üîÑ √Ä IMPL√âMENTER
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ... (m√™me structure)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ MarqueursEffortIndicator/    # ‚úÖ EXISTANT (√† migrer)
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ PatternsResistanceIndicator/ # ‚úÖ EXISTANT (√† migrer)
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ RobustesseStressIndicator/   # ‚úÖ EXISTANT (√† migrer)
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ NiveauStressIndicator/       # ‚úÖ EXISTANT (√† migrer)
‚îÇ   ‚îî‚îÄ‚îÄ üìÇ PositionConversationIndicator/ # ‚úÖ EXISTANT (√† migrer)
‚îÇ
‚îú‚îÄ‚îÄ CognitiveMetricsConfig.ts           # üîÑ √Ä CR√âER
‚îú‚îÄ‚îÄ CognitiveMetricsRegistry.ts         # üîÑ √Ä CR√âER
‚îú‚îÄ‚îÄ CognitiveMetrics.tsx                # ‚úÖ EXISTANT (√† adapter au framework)
‚îÇ
‚îî‚îÄ‚îÄ üìÇ migration/                       # üîÑ OUTILS DE MIGRATION
    ‚îú‚îÄ‚îÄ adaptUseCognitiveMetrics.ts     # Adaptation hook existant
    ‚îú‚îÄ‚îÄ adaptIndicatorData.ts           # Migration donn√©es existantes
    ‚îú‚îÄ‚îÄ compatibilityLayer.ts           # Couche compatibilit√©
    ‚îî‚îÄ‚îÄ migrationGuide.md               # Guide migration step-by-step
```

### üîÑ √âtat actuel des m√©triques cognitives

#### **‚úÖ Impl√©mentation existante (hors framework)**

**Localisation actuelle** : `app/(protected)/analysis/components/CognitiveMetrics.tsx`

**Hook existant** : `useCognitiveMetrics.ts`

```typescript
// Structure actuelle (√† migrer)
export const useCognitiveMetrics = (data: TaggedTurn[]) => {
  return {
    // Indicateurs existants
    fluiditeCognitive: FluiditeScore,
    reactionsDirectes: ReactionsScore,
    reprisesLexicales: ReprisesScore,
    chargeCognitive: ChargeScore,
    marqueursEffort: EffortScore,
    patternsResistance: ResistanceScore,
    robustesseStress: StressScore,
    niveauStress: StressLevelScore,
    positionConversation: PositionScore,

    // M√©triques globales
    scoreGlobalCognitif: number,
    tendancesEvolution: TrendAnalysis,
  };
};
```

#### **üìä Indicateurs cognitifs op√©rationnels**

1. **‚úÖ Fluidit√© Cognitive** - Mesure de la spontan√©it√© conversationnelle
   - D√©tection des h√©sitations, pauses, reformulations
   - Score bas√© sur la fluidit√© du discours conseiller
2. **‚úÖ R√©actions Directes** - Vitesse de r√©action aux interventions client
   - Temps de latence entre tour client et r√©ponse conseiller
   - Analyse de la r√©activit√© conversationnelle
3. **‚úÖ Reprises Lexicales** - R√©utilisation du vocabulaire client
   - D√©tection des mots/expressions repris du client
   - Mesure de l'adaptation linguistique
4. **‚úÖ Charge Cognitive** - Complexit√© du traitement conversationnel
   - Longueur des tours, complexit√© syntaxique
   - Indicateurs de surcharge cognitive
5. **‚úÖ Marqueurs d'Effort** - Signes de difficult√© conversationnelle
   - D√©tection "euh", "ben", pauses longues
   - Quantification de l'effort conversationnel
6. **‚úÖ Patterns de R√©sistance** - D√©tection des blocages conversationnels
   - R√©p√©titions, reformulations multiples
   - Patterns de difficult√©s r√©currentes
7. **‚úÖ Robustesse au Stress** - Maintien de la performance sous pression
   - Stabilit√© des m√©triques dans contextes difficiles
   - R√©silience conversationnelle
8. **‚úÖ Niveau de Stress** - Intensit√© du stress conversationnel
   - Combinaison de marqueurs physiologiques linguistiques
   - Score global de tension
9. **‚úÖ Position dans la Conversation** - √âvolution temporelle des m√©triques
   - Tendances d√©but/milieu/fin de conversation
   - Patterns d'√©volution cognitive

### ‚úÖ FeedbackAlignmentIndicator - Statut Complet

**Localisation** : `li-metrics/indicators/FeedbackAlignmentIndicator/`

#### **Fonctionnalit√©s op√©rationnelles** :

**‚úÖ BasicAlignmentAlgorithm.ts** - Moteur d'analyse s√©mantique

- Lexiques fran√ßais √©tendus (145 patterns : POSITIF/NEGATIF/NEUTRE)
- Analyse des verbatims client avec scoring de confidence
- Recherche des r√©actions client (temporelle + next_turn)
- Calcul par familles de strat√©gies (REFLET/ENGAGEMENT/EXPLICATION/OUVERTURE)
- Validation qualit√© et filtrage des r√©sultats

**‚úÖ FeedbackAlignmentInterface.tsx** - Interface utilisateur

- Affichage des r√©sultats par famille avec scores d'efficacit√©
- Dialog interactif "Lexiques Complets" avec 145 patterns visibles
- Cartes cliquables par sentiment avec animations
- Export des r√©sultats + lexiques
- Interface responsive (Box/Flexbox, compatible MUI)

**‚úÖ useFeedbackAlignmentMetrics.ts** - Hook de donn√©es

- Chargement de tous les turntagged (3652+ enregistrements)
- Pagination Supabase automatique (contournement limite 1000)
- Cache intelligent et optimisations de performance
- Gestion d'erreurs et √©tats de chargement
- Filtrage par origine avec diagnostics

#### **R√©sultats scientifiques valid√©s** :

```
üìä Efficacit√© par strat√©gie (analyse de 1397 tours) :
ü•á OUVERTURE:    48.3% verbatims positifs (175 occurrences)
ü•à ENGAGEMENT:   34.5% verbatims positifs (182 occurrences)
ü•â REFLET:       18.2% verbatims positifs (444 occurrences)
‚ùå EXPLICATION:   1.0% verbatims positifs (596 occurrences)

‚úÖ Hypoth√®ses valid√©es : H1 (ACTION > EXPLICATION), H2 (EXPLICATION inefficace)
üìä Couverture : 72% (1006/1397 verbatims analys√©s)
üéØ Confidence moyenne : >75%
```

#### **üîÑ Prochaines √©tapes FeedbackAlignment** :

1. **SentimentEnhancedAlgorithm.ts** - Algorithme avec NLP avanc√©
   - Int√©gration analyse de sentiment plus sophistiqu√©e
   - D√©tection √©motions (joie, frustration, surprise, etc.)
   - Analyse de l'intensit√© √©motionnelle
   - Comparaison avec BasicAlgorithm
2. **SequentialPatternAlgorithm.ts** - Patterns s√©quentiels
   - D√©tection de s√©quences strat√©gie ‚Üí r√©action r√©currentes
   - Analyse des encha√Ænements optimaux
   - Patterns temporels et contextuels
3. **Interface comparative** - Comparaison d'algorithmes
   - Vue c√¥te-√†-c√¥te des r√©sultats Basic vs Enhanced vs Sequential
   - M√©triques de performance comparatives
   - Tests A/B automatis√©s

## üîó Composants Partag√©s

### √âtat d'impl√©mentation

```
shared/                                 # üîó COMPOSANTS PARTAG√âS
‚îú‚îÄ‚îÄ üìÇ atoms/                          # ‚öõÔ∏è COMPOSANTS ATOMIQUES
‚îÇ   ‚îú‚îÄ‚îÄ IndicatorHeader.tsx            # ‚úÖ IMPL√âMENT√â
‚îÇ   ‚îú‚îÄ‚îÄ ColorLegend.tsx                # ‚úÖ IMPL√âMENT√â
‚îÇ   ‚îú‚îÄ‚îÄ AlgorithmDetailDialog.tsx      # ‚úÖ IMPL√âMENT√â
‚îÇ   ‚îî‚îÄ‚îÄ [autres atoms...]              # üîÑ √Ä IMPL√âMENTER
‚îÇ
‚îú‚îÄ‚îÄ üìÇ molecules/                      # üß¨ COMPOSANTS MOL√âCULAIRES
‚îÇ   ‚îú‚îÄ‚îÄ ResultsTable.tsx               # ‚úÖ IMPL√âMENT√â
‚îÇ   ‚îú‚îÄ‚îÄ AlgorithmLogicExplanation.tsx  # ‚úÖ IMPL√âMENT√â (avec lexiques)
‚îÇ   ‚îú‚îÄ‚îÄ types.ts                       # ‚úÖ ExtendedAlgorithmLogicProps
‚îÇ   ‚îî‚îÄ‚îÄ [autres molecules...]          # üîÑ √Ä IMPL√âMENTER
‚îÇ
‚îú‚îÄ‚îÄ üìÇ hooks/                          # ü™ù HOOKS PARTAG√âS
‚îÇ   ‚îú‚îÄ‚îÄ useAlgorithmDialog.ts          # ‚úÖ IMPL√âMENT√â
‚îÇ   ‚îî‚îÄ‚îÄ [autres hooks...]              # üîÑ √Ä IMPL√âMENTER
‚îÇ
‚îî‚îÄ‚îÄ üìÇ utils/                          # üõ†Ô∏è UTILITAIRES PARTAG√âS
    ‚îî‚îÄ‚îÄ [utils...]                     # üîÑ √Ä IMPL√âMENTER
```

#### **‚úÖ AlgorithmLogicExplanation** - Composant enrichi

**Fonctionnalit√©s op√©rationnelles** :

- Interface multicouche pour affichage des lexiques
- Dialog "Vue d√©taill√©e" avec scrolling optimis√©
- Cartes interactives par sentiment avec animations
- Support types √©tendus (`ExtendedAlgorithmLogicProps`)
- Composants factoris√©s (`LexiconCategory`, `DetailedLexicon`)

## üìä Centre d'Analyse

### Page principale

**Localisation** : `app/(protected)/analysis/page.tsx`

```typescript
// Structure actuelle
export default function AnalysisPage() {
  return (
    <AnalysisLayout>
      <Box sx={{ display: "flex", flexDirection: "column", gap: 3 }}>
        {/* ‚úÖ Onglet Feedback Alignment - OP√âRATIONNEL */}
        <FeedbackAlignmentInterface
          selectedOrigin={selectedOrigin}
          showDetailedResults={true}
          showComparison={false} // üîÑ √Ä activer avec multi-algorithmes
        />
        {/* üîÑ Onglets √† impl√©menter */}
        <CommonGroundInterface /> {/* √Ä IMPL√âMENTER */}
        <BackchannelsInterface /> {/* √Ä IMPL√âMENTER */}
        <CognitiveMetricsInterface /> {/* √Ä MIGRER */}
      </Box>
    </AnalysisLayout>
  );
}
```

## üóÑÔ∏è Base de Donn√©es

### Tables existantes (utilis√©es)

```sql
-- ‚úÖ Donn√©es conversationnelles (op√©rationnelles)
turntagged (
  id INTEGER PRIMARY KEY,
  call_id INTEGER,
  start_time FLOAT,
  end_time FLOAT,
  tag TEXT,
  verbatim TEXT,               -- ‚úÖ Analys√© par moteur s√©mantique
  next_turn_verbatim TEXT,     -- ‚úÖ Verbatim client analys√©
  next_turn_tag TEXT,
  speaker TEXT
);

-- ‚úÖ Tags et familles (op√©rationnels)
lpltag (
  id INTEGER PRIMARY KEY,
  label TEXT,
  family TEXT,                -- ‚úÖ CL√â pour analyse par famille
  originespeaker TEXT,        -- conseiller/client
  color TEXT,
  description TEXT
);

-- ‚úÖ Appels (op√©rationnels)
call (
  callid TEXT PRIMARY KEY,
  filename TEXT,
  filepath TEXT,
  origine TEXT,               -- ‚úÖ Filtre par origine
  duree INTEGER,
  is_tagging_call BOOLEAN,
  preparedfortranscript BOOLEAN
);
```

### üîÑ Tables Framework (√† impl√©menter)

```sql
-- üîÑ Syst√®me d'annotation unifi√©
CREATE TABLE metric_annotations (
  id SERIAL PRIMARY KEY,
  turn_id INTEGER REFERENCES turntagged(id),
  domain TEXT NOT NULL,              -- 'li' | 'cognitive'
  indicator_id TEXT NOT NULL,        -- 'feedback_alignment', 'common_ground'
  human_label TEXT NOT NULL,         -- Annotation experte
  algorithm_prediction TEXT,         -- Pr√©diction algorithme
  algorithm_confidence FLOAT,        -- Confiance (0-1)
  annotator_id TEXT NOT NULL,
  created_at TIMESTAMP DEFAULT NOW()
);

-- üîÑ Performance algorithmes
CREATE TABLE algorithm_performance (
  id SERIAL PRIMARY KEY,
  domain TEXT NOT NULL,
  indicator_id TEXT NOT NULL,
  algorithm_id TEXT NOT NULL,
  accuracy FLOAT,
  precision FLOAT,
  recall FLOAT,
  f1_score FLOAT,
  processing_time_ms INTEGER,
  test_date TIMESTAMP DEFAULT NOW()
);

-- üîÑ Validation crois√©e AC-LI-Cognitif
CREATE TABLE convergence_validations (
  id SERIAL PRIMARY KEY,
  validation_date TIMESTAMP DEFAULT NOW(),
  kendall_tau_ac_li FLOAT,
  kendall_tau_ac_cognitive FLOAT,
  kendall_tau_li_cognitive FLOAT,
  overall_consistency FLOAT,
  h1_action_effectiveness_validated BOOLEAN,
  h2_explanation_difficulty_validated BOOLEAN,
  convergence_status TEXT
);
```

## üéØ Roadmap d'Impl√©mentation

### üîÑ **Phase 1 : Extension FeedbackAlignment (Priorit√© Imm√©diate)**

#### **1.1 Deuxi√®me algorithme (2-3 jours)**

```typescript
// √Ä cr√©er : SentimentEnhancedAlgorithm.ts
class SentimentEnhancedAlgorithm extends BasicAlignmentAlgorithm {
  // Extension avec analyse sentiment plus sophistiqu√©e
  // D√©tection √©motions granulaires
  // Comparaison directe avec BasicAlgorithm
}
```

#### **1.2 Interface comparative (1-2 jours)**

```typescript
// √Ä modifier : FeedbackAlignmentInterface.tsx
<AlgorithmComparisonView
  algorithms={["basic", "sentiment-enhanced"]}
  results={comparisonResults}
  showSideBySide={true}
/>
```

#### **1.3 Documentation scientifique (1-2 jours)**

- G√©n√©ration automatique de tableaux pour th√®se
- Export des r√©sultats en format acad√©mique
- Graphiques de comparaison algorithmes
- M√©triques de validation scientifique

### üîÑ **Phase 2 : Framework Core (1-2 semaines)**

#### **2.1 Architecture de base**

```typescript
// √Ä cr√©er : metrics-framework/core/
- BaseIndicator.ts           # Classe abstraite
- AlgorithmStrategy.ts       # Interface algorithmes
- MetricsEngine.ts          # Moteur unifi√©
- types/ (base, indicators, algorithms, results)
```

#### **2.2 Registry pattern**

```typescript
// √Ä cr√©er : MetricsRegistry.ts
class MetricsRegistry {
  registerIndicator(indicator: BaseIndicator): void;
  getIndicator(id: string): BaseIndicator;
  getAlgorithms(indicatorId: string): AlgorithmStrategy[];
  runComparison(indicatorId: string, algorithms: string[]): ComparisonResult;
}
```

#### **2.3 Hook principal unifi√©**

```typescript
// √Ä cr√©er : useMetricsEngine.ts
export const useMetricsEngine = (config: MetricsEngineConfig) => {
  return {
    indicators: BaseIndicator[],
    results: Record<string, IndicatorResult>,
    compareAlgorithms: (algorithms: string[]) => Promise<AlgorithmComparison>,
    runBenchmark: (testData: AnnotatedData[]) => Promise<BenchmarkResults>
  };
};
```

### üîÑ **Phase 3 : Migration M√©triques Cognitives (1-2 semaines)**

#### **3.1 Migration FluiditeCognitiveIndicator**

```typescript
// √âtape 1 : Cr√©er structure framework
cognitive-metrics/indicators/FluiditeCognitiveIndicator/
‚îú‚îÄ‚îÄ algorithms/BasicFluidityAlgorithm.ts     # Migration du hook existant
‚îú‚îÄ‚îÄ hooks/useFluiditeCognitiveMetrics.ts     # Adaptation au framework
‚îú‚îÄ‚îÄ FluiditeCognitiveInterface.tsx           # Nouvelle interface
‚îî‚îÄ‚îÄ types.ts                                 # Types sp√©cifiques

// √âtape 2 : Migrer logique existante
class BasicFluidityAlgorithm {
  // Migration depuis useCognitiveMetrics
  calculateFluiditeScore(turns: TaggedTurn[]): FluiditeResult {
    // Logique existante adapt√©e
  }
}
```

#### **3.2 Migration des 8 autres indicateurs cognitifs**

- **ReactionsDirectesIndicator** : Temps de latence conversationnelle
- **ReprisesLexicalesIndicator** : R√©utilisation vocabulaire client
- **ChargeCognitiveIndicator** : Complexit√© traitement conversationnel
- **MarqueursEffortIndicator** : D√©tection signes de difficult√©
- **PatternsResistanceIndicator** : Blocages conversationnels
- **RobustesseStressIndicator** : Maintien performance sous pression
- **NiveauStressIndicator** : Intensit√© stress conversationnel
- **PositionConversationIndicator** : √âvolution temporelle m√©triques

#### **3.3 Interface unifi√©e CognitiveMetrics**

```typescript
// Adapter CognitiveMetrics.tsx existant au framework
<CognitiveMetricsInterface>
  <IndicatorTabs>
    <Tab
      label="Fluidit√© Cognitive"
      component={<FluiditeCognitiveInterface />}
    />
    <Tab
      label="R√©actions Directes"
      component={<ReactionsDirectesInterface />}
    />
    <Tab
      label="Reprises Lexicales"
      component={<ReprisesLexicalesInterface />}
    />
    {/* ... autres indicateurs */}
  </IndicatorTabs>

  <GlobalCognitiveScore
    indicators={allCognitiveIndicators}
    showTrends={true}
    showComparison={true}
  />
</CognitiveMetricsInterface>
```

### üîÑ **Phase 4 : Nouveaux Indicateurs LI (2-3 semaines)**

#### **4.1 CommonGroundIndicator**

- Algorithme de d√©tection r√©f√©rences partag√©es
- Interface d'analyse du terrain commun
- M√©triques de coh√©sion conversationnelle

#### **4.2 BackchannelsIndicator**

- D√©tection des signaux d'√©coute (mm-hmm, oui, etc.)
- Analyse de la synchronisation conversationnelle
- Patterns de feedback non-verbal

#### **4.3 SequentialPatternsIndicator**

- Analyse des s√©quences turn-by-turn
- D√©tection de patterns r√©currents
- Optimisation des encha√Ænements conversationnels

### üîÑ **Phase 5 : Validation Scientifique (3-4 semaines)**

#### **4.1 Syst√®me d'annotation**

- Interface d'annotation experte
- Workflow de validation crois√©e
- M√©triques inter-annotateur

#### **4.2 Validation crois√©e AC-LI-Cognitif**

- Tests de convergence automatis√©s
- Dashboard de validation scientifique
- G√©n√©ration de rapports de recherche

## üìã **Prochaines T√¢ches Concr√®tes**

### **T√¢che 1 : Deuxi√®me algorithme FeedbackAlignment (URGENT pour th√®se)**

**Objectif** : Cr√©er `SentimentEnhancedAlgorithm.ts` pour comparaison scientifique

**Livrables** :

```typescript
// 1. Fichier √† cr√©er
li-metrics/indicators/FeedbackAlignmentIndicator/algorithms/SentimentEnhancedAlgorithm.ts

// 2. M√©thodes √† impl√©menter
- analyzeEmotionalIntensity(verbatim: string): EmotionalScore
- detectGranularSentiments(verbatim: string): GranularSentiment[]
- compareWithBaseline(basicResult: AlignmentResult): ComparisonMetrics

// 3. Interface √† modifier
FeedbackAlignmentInterface.tsx
- Ajouter s√©lecteur d'algorithme
- Affichage comparatif des r√©sultats
- M√©triques de performance diff√©rentielle
```

### **T√¢che 2 : Export documentation th√®se (URGENT)**

**Objectif** : G√©n√©rer tableaux et graphiques pour insertion dans th√®se

**Livrables** :

```typescript
// 1. Hook d'export √† cr√©er
useThesisExport.ts
- generateResultsTable(): AcademicTable
- generateComparisonChart(): ChartConfig
- generateMethodologyDescription(): LatexContent
- exportToPDF(): Buffer

// 2. Formats de sortie
- Tableaux LaTeX format√©s
- Graphiques haute r√©solution (SVG/PNG)
- Descriptions m√©thodologiques
- M√©triques de validation
```

### **T√¢che 3 : Migration premi√®re m√©trique cognitive (PRIORIT√â MOYENNE)**

**Objectif** : Migrer FluiditeCognitiveIndicator vers le framework

**Livrables** :

```typescript
// 1. Structure √† cr√©er
cognitive-metrics/indicators/FluiditeCognitiveIndicator/
‚îú‚îÄ‚îÄ algorithms/BasicFluidityAlgorithm.ts
‚îú‚îÄ‚îÄ hooks/useFluiditeCognitiveMetrics.ts
‚îú‚îÄ‚îÄ FluiditeCognitiveInterface.tsx
‚îî‚îÄ‚îÄ types.ts

// 2. Migration de la logique existante
// Depuis : useCognitiveMetrics.ts (hook actuel)
// Vers : BasicFluidityAlgorithm.ts (algorithme framework)

// 3. Adaptation de l'interface
// Depuis : CognitiveMetrics.tsx (composant monolithique)
// Vers : FluiditeCognitiveInterface.tsx (composant modulaire)
```

### **T√¢che 4 : Tests de validation (IMPORTANT)**

**Objectif** : Valider la robustesse des algorithmes

**Livrables** :

```typescript
// 1. Tests automatis√©s
algorithms/__tests__/
- BasicAlignmentAlgorithm.test.ts
- SentimentEnhancedAlgorithm.test.ts
- ComparisonValidation.test.ts

// 2. M√©triques de qualit√©
- Pr√©cision sur √©chantillon annot√©
- Temps de traitement benchmark
- Stabilit√© inter-ex√©cutions
- Couverture d'analyse
```

## üîß **Setup pour Nouvelle Session**

### **Contexte projet**

- **Framework** : Architecture modulaire pour m√©triques comparables
- **√âtat actuel** : FeedbackAlignment op√©rationnel avec BasicAlgorithm
- **Donn√©es** : 3652+ enregistrements turntagged, 145 patterns linguistiques
- **R√©sultats** : Hypoth√®ses H1 & H2 valid√©es scientifiquement

### **Fichiers cl√©s √† examiner**

```bash
# Structure existante
src/app/(protected)/analysis/components/
‚îú‚îÄ‚îÄ li-metrics/indicators/FeedbackAlignmentIndicator/
‚îÇ   ‚îú‚îÄ‚îÄ algorithms/BasicAlignmentAlgorithm.ts        # ‚úÖ Moteur s√©mantique
‚îÇ   ‚îú‚îÄ‚îÄ FeedbackAlignmentInterface.tsx               # ‚úÖ Interface compl√®te
‚îÇ   ‚îú‚îÄ‚îÄ hooks/useFeedbackAlignmentMetrics.ts         # ‚úÖ Hook donn√©es
‚îÇ   ‚îî‚îÄ‚îÄ types.ts                                     # ‚úÖ Types
‚îú‚îÄ‚îÄ shared/molecules/
‚îÇ   ‚îú‚îÄ‚îÄ AlgorithmLogicExplanation.tsx                # ‚úÖ Composant enrichi
‚îÇ   ‚îî‚îÄ‚îÄ types.ts                                     # ‚úÖ ExtendedAlgorithmLogicProps
‚îú‚îÄ‚îÄ shared/atoms/                                    # ‚úÖ Composants atomiques
‚îî‚îÄ‚îÄ CognitiveMetrics.tsx                             # ‚úÖ M√©triques cognitives existantes

# Hook cognitif existant (√† migrer)
src/hooks/useCognitiveMetrics.ts                     # ‚úÖ 9 indicateurs op√©rationnels
```

### **APIs disponibles**

```typescript
// Hook principal FeedbackAlignment
const {
  tableRows, // Donn√©es format√©es pour affichage
  analysisResults, // R√©sultats par famille + sentiment
  stats, // Statistiques globales
  runAnalysis, // Lance analyse compl√®te
  debugInfo, // Diagnostics + m√©tadonn√©es
} = useFeedbackAlignmentMetrics({ selectedOrigin, algorithmType: "basic" });

// Algorithme d'analyse
const algorithm = new BasicAlignmentAlgorithm(turnTaggedData);
const results = algorithm.analyzeAlignment(); // Retourne AlignmentAnalysis
algorithm.diagnoseVerbatims(); // Diagnostics qualit√© donn√©es

// Hook cognitif existant (√† migrer vers framework)
const {
  fluiditeCognitive, // Score fluidit√© conversationnelle
  reactionsDirectes, // Temps de latence r√©actions
  reprisesLexicales, // R√©utilisation vocabulaire client
  chargeCognitive, // Complexit√© traitement
  marqueursEffort, // Signes de difficult√© ("euh", pauses)
  patternsResistance, // Blocages conversationnels
  robustesseStress, // Maintien performance sous pression
  niveauStress, // Intensit√© stress conversationnel
  positionConversation, // √âvolution temporelle
  scoreGlobalCognitif, // Score composite
} = useCognitiveMetrics(turnTaggedData);
```

### **Donn√©es de test**

- **Source** : Table `turntagged` (3652 enregistrements)
- **Filtrage** : Par origine, famille de strat√©gie
- **Couverture** : 72% des tours analysables (1006/1397)
- **Qualit√©** : Confidence moyenne >75%

Le framework est pr√™t pour extension avec nouveaux algorithmes et indicateurs ! üöÄ
