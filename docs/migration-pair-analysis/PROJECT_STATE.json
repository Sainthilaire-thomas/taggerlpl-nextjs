{
  "project": {
    "name": "taggerlpl-nextjs",
    "description": "Application d'analyse conversationnelle pour th√®se PhD - Syst√®me de tagging et validation algorithmique",
    "path": "C:\\Users\\thoma\\OneDrive\\SONEAR_2025\\taggerlpl-nextjs",
    "repository": "https://github.com/Sainthilaire-thomas/taggerlpl-nextjs.git"
  },
  "session": {
    "lastUpdate": "2025-11-21T01:00:00Z",
    "lastSession": "SESSION_MIGRATION_M2_BILAN.md",
    "duration": "2h30",
    "focus": "Migration et validation algorithmes M2 (alignement linguistique)"
  },
  "git": {
    "branch": "refactor/architecture-phases",
    "lastCommit": "ee05c59",
    "commitMessage": "‚úÖ feat(level1): Support algorithmes M2 (alignement linguistique)",
    "filesChanged": 9,
    "linesAdded": 1594,
    "status": "‚úÖ Clean - Pushed to origin"
  },
  "architecture": {
    "phase": "Phase 4 - Migration M√©diateurs (M1, M2, M3)",
    "database": {
      "table": "analysis_pairs",
      "rows": 901,
      "structure": "Paires conseiller-client avec contexte √©tendu (prev3 ‚Üí next3)"
    },
    "samples": {
      "total": 2703,
      "breakdown": {
        "conseiller": 901,
        "client": 901,
        "M2": 901
      },
      "strategy": "3 samples par paire (conseiller + client + M2)"
    }
  },
  "algorithms": {
    "X": {
      "status": "‚úÖ Fonctionnel",
      "tested": ["RegexXClassifier"],
      "target": "conseiller",
      "columns": ["x_predicted_tag", "x_confidence", "x_algorithm_key", "x_algorithm_version"]
    },
    "Y": {
      "status": "‚úÖ Fonctionnel",
      "tested": ["RegexYClassifier"],
      "target": "client",
      "columns": ["y_predicted_tag", "y_confidence", "y_algorithm_key", "y_algorithm_version"]
    },
    "M1": {
      "status": "üîÑ √Ä tester",
      "algorithms": ["M1ActionVerbCounter"],
      "target": "conseiller",
      "input": "string (verbatim conseiller)",
      "columns": ["m1_verb_density", "m1_verb_count", "m1_total_words", "m1_action_verbs"],
      "note": "R√©utilise les samples conseiller (target='conseiller')"
    },
    "M2": {
      "status": "‚úÖ Fonctionnel - 10 samples valid√©s",
      "algorithms": [
        "M2LexicalAlignment",
        "M2SemanticAlignment (√† tester)",
        "M2CompositeAlignment (√† tester)"
      ],
      "target": "M2 (paire compl√®te)",
      "input": "M2Input {t0: string, t1: string}",
      "columns": ["m2_lexical_alignment", "m2_semantic_alignment", "m2_global_alignment", "m2_shared_terms"],
      "tested": {
        "algorithm": "M2LexicalAlignment",
        "samples": 10,
        "success": 10,
        "errors": 0,
        "version": "M2LexicalAlignment-v1.0.0-8sn7st"
      },
      "note": "Utilise un sample d√©di√© (target='M2') avec t0 et t1 en metadata"
    },
    "M3": {
      "status": "üîÑ √Ä tester",
      "algorithms": ["PausesM3Calculator"],
      "target": "client",
      "input": "M3Input {segment: string, options: {...}}",
      "columns": ["m3_hesitation_count", "m3_cognitive_score", "m3_cognitive_load", "m3_patterns"],
      "note": "R√©utilise les samples client (target='client')"
    }
  },
  "criticalFiles": {
    "types": {
      "base": "src/types/algorithm-lab/algorithms/base.ts",
      "note": "Configs ALGORITHM_CONFIGS et type SpeakerType √©tendu (M1/M2/M3)"
    },
    "utils": {
      "corpusFilters": "src/types/algorithm-lab/utils/corpusFilters.ts",
      "note": "Filtrage par speakerType et requiresNextTurn adapt√© pour M2"
    },
    "inputPreparation": {
      "file": "src/types/algorithm-lab/utils/inputPreparation.ts",
      "note": "Case 'alignment' utilise metadata.t0 et metadata.t1"
    },
    "hooks": {
      "useLevel1Testing": "src/features/phase3-analysis/level1-validation/ui/hooks/useLevel1Testing.ts",
      "note": "mapH2ToGoldStandard cr√©e 3 samples par paire, logs debug √† supprimer (lignes 543-554)"
    }
  },
  "issues": {
    "current": [
      {
        "priority": "HIGH",
        "type": "cleanup",
        "description": "Supprimer logs de debug dans useLevel1Testing.ts",
        "location": "lignes 543-554",
        "time": "5 min"
      },
      {
        "priority": "MEDIUM",
        "type": "typescript",
        "description": "Corriger warnings TypeScript 'as any' pour target: 'M2'",
        "location": "useLevel1Testing.ts lignes 422, 547, 551",
        "time": "5 min"
      }
    ],
    "resolved": [
      {
        "date": "2025-11-21",
        "issue": "M2 ne trouvait aucun sample compatible",
        "solution": "Extension SpeakerType + filtrage adapt√© + cr√©ation sample M2 d√©di√©"
      }
    ]
  },
  "nextSteps": {
    "immediate": [
      "Supprimer logs de debug dans useLevel1Testing.ts (lignes 543-554)",
      "Tester M1ActionVerbCounter sur 10 samples",
      "Tester PausesM3Calculator sur 10 samples",
      "Tester M2SemanticAlignment sur 10 samples",
      "Tester M2CompositeAlignment sur 10 samples"
    ],
    "shortTerm": [
      "V√©rifier donn√©es en DB avec requ√™te SQL",
      "Corriger warnings TypeScript (as any)",
      "Valider tous les m√©diateurs sur 50 samples"
    ],
    "optional": [
      "Impl√©menter bulk upsert pour performance (15min ‚Üí 30sec pour 901 paires)",
      "Valider corpus complet (901 paires)"
    ]
  },
  "documentation": {
    "architecture": {
      "file": "docs/migration-pair-analysis/ARCHITECTURE_ALGORITHMES_ANALYSIS_PAIRS.md",
      "description": "Architecture compl√®te du syst√®me avec analysis_pairs et workflow 3 niveaux"
    },
    "lastSession": {
      "file": "docs/migration-pair-analysis/SESSION_MIGRATION_M2_BILAN.md",
      "description": "Bilan d√©taill√© session M2 avec corrections effectu√©es et prochaines √©tapes"
    },
    "targetArchitecture": {
      "file": "docs/architecture/ARCHITECTURE_CIBLE_WORKFLOW.md",
      "description": "Vision d'ensemble de l'architecture cible"
    }
  },
  "devCommands": {
    "start": "npm run dev",
    "database": {
      "checkM2": "SELECT pair_id, m2_lexical_alignment, m2_shared_terms FROM analysis_pairs WHERE m2_lexical_alignment IS NOT NULL LIMIT 10;",
      "countResults": "SELECT COUNT(*) FROM analysis_pairs WHERE m2_lexical_alignment IS NOT NULL;",
      "recentUpdates": "SELECT * FROM analysis_pairs WHERE updated_at > NOW() - INTERVAL '1 hour' ORDER BY updated_at DESC LIMIT 20;"
    },
    "git": {
      "status": "git status",
      "diff": "git diff src/types/algorithm-lab/",
      "log": "git log --oneline -5"
    }
  },
  "performance": {
    "current": {
      "updateMethod": "Individual UPDATEs",
      "time": "~90 seconds for 901 pairs",
      "bottleneck": "1 requ√™te SQL par paire"
    },
    "target": {
      "updateMethod": "Bulk upsert",
      "estimatedTime": "< 2 seconds for 901 pairs",
      "gain": "45x faster"
    }
  },
  "keyLearnings": {
    "architecture": [
      "M2 n√©cessite un sample d√©di√© (target='M2') avec t0 et t1",
      "M1 et M3 r√©utilisent les samples existants (conseiller/client)",
      "Le syst√®me √† 3 samples par paire (conseiller/client/M2) est valid√©"
    ],
    "technical": [
      "SpeakerType doit √™tre √©tendu pour supporter M1/M2/M3",
      "Le filtrage requiresNextTurn doit v√©rifier t0 et t1 pour M2",
      "inputPreparation doit utiliser metadata.t0 et metadata.t1 pour M2"
    ],
    "workflow": [
      "Toujours commencer par lire les fichiers SKILL.md avant d'utiliser les outils",
      "Valider sur 10 samples avant de traiter le corpus complet",
      "Documenter chaque session pour faciliter la continuit√©"
    ]
  },
  "testScenarios": {
    "M1": {
      "input": "je vais v√©rifier votre dossier et traiter votre demande",
      "expected": {
        "m1_verb_count": 2,
        "m1_action_verbs": ["v√©rifier", "traiter"]
      }
    },
    "M2": {
      "input": {
        "t0": "je vais traiter votre demande",
        "t1": "d'accord pour le traitement"
      },
      "expected": {
        "m2_lexical_alignment": "> 0.5",
        "m2_shared_terms": ["traiter", "demande"]
      }
    },
    "M3": {
      "input": "euh... je... comment dire... c'est compliqu√©",
      "expected": {
        "m3_hesitation_count": "‚â• 3",
        "m3_cognitive_load": "ELEVEE"
      }
    }
  },
  "contactContext": {
    "researcher": "Thomas (PhD student)",
    "project": "Analyse conversationnelle call center",
    "hypothesis": {
      "H1": "R√©action client pr√©visible par strat√©gie conseiller",
      "H2": "Relation m√©di√©e par M1, M2, M3"
    },
    "methodology": {
      "Level0": "Gold standard (annotations manuelles)",
      "Level1": "Validation algorithmique (en cours)",
      "Level2": "Test hypoth√®ses H1/H2 (√† venir)"
    }
  },
  "quickStartSession": "Bonjour ! Je continue le projet taggerlpl-nextjs.\n\nüìç Contexte :\n- Branche : refactor/architecture-phases\n- Commit : ee05c59 (M2 fonctionnel)\n- Phase : Validation M1/M2/M3\n\nüìÑ Lire en priorit√© :\n- PROJECT_STATE.json (ce fichier)\n- SESSION_MIGRATION_M2_BILAN.md\n\nüéØ Objectif session : [d√©crire ici]"
}
